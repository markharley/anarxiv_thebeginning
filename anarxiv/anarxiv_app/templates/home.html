<hmtl>
{% load staticfiles %}

<head>
	<title>
		This is the homepage
	</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="{% static 'js/home.js' %}"></script>
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
	<link rel="stylesheet" href="{% static 'css/home.css' %}">

</head>

<body>


	<div id = "wrapper">

		<div id = "header">
			<h1> Welcome to the <a id = "homelink" href = "/home/">ANARXIV </a>: The place where you can call academics out.</h1>
			<div id = "userNotLoggedIn" 
				{% if user.is_authenticated %} 
					class="hidden hangright" 
				{% else %} 
					class="hangright" 
				{% endif %} > 
				<a href="#" data-toggle="modal" data-backdrop="" data-keyboard="false" data-target="#loginModal"> Login </href> 
			</div>
			<div id = "userLoggedIn" 
				{% if not user.is_authenticated %} 
					class="hidden hangright" 
				{% else %} 
					class="hangright" 
				{% endif %} >
				<h3> Hello {{user.name}} </h3>
			</div>
		</div>

		  <div class="modal fade in" tabindex="-1" id="loginModal" role="dialog">
		    <div class="modal-dialog">
		    
		      	<!-- Modal content-->
		    	<div class="modal-content">
		        <div class="modal-header">
		          	<button type="button" class="close" data-dismiss="modal">&times;</button>
		          	<h4 class="modal-title">Login</h4>
		        </div>
		        <div class="modal-body">
		          	<p>Please enter your username and password</p>
		          	<form id="loginForm" action method="#">
		          		<input id="loginUser" type="text" placeholder="username">
		          		<input id="loginPassword" type="password" placeholder="password">
		          	</form>
		        </div>
		        <div class="modal-footer">
		          	<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		        </div>
		    </div>

		  	</div>
		</div>

		<div id = "content">
			<h2> Physics </h2>
				<ul>
					{% for location, name in subAnarxivs.items %}
						<li> <a href="subanarxiv/{{location}}">{{name}}</a>  </li>
					{% endfor %}
				</ul>

			<button type="button" onclick="toggleClicked()" id = "toggleButton">Log Me In</button>
			<div id="username"> 
				<span>No user</span>
			</div>
			<input type="text" id="surname" value="bartrum"> 
			<button type="button" onclick="searchButtonClicked()" id = "searchButton">Search</button>

			<div id= "test"> <br> </div>
				
			<div id="spinner" class="spinner" style="display:none;">
    		<img id="img-spinner" src="{% static 'images/spinner.gif' %}" alt="Loading"/>
			</div>

			<center><div id = "searchFail" style ="display:none;"> No results found... </div></center>
			<script type="text/javascript" src="{% static 'js/home.js' %}"></script>


			 <script type = "text/javascript">


				function searchButtonClicked() {
					$('#searchFail').css("display","none");
					$('#test').html("");

					$("#spinner").css("display", "block"); 

					var x = document.getElementById("surname").value;
		 			$.ajax({
		         		type: "POST",
		           		url: "../home/search/",
		           		data: {'info': x},
		           		datatype: "JSON",

		           		success: function(data) {
		          			$("#spinner").css("display", "none");

		           			var length = data['htmlList'].length;
		           		
		           			for(var i =0; i < length; i++){
		           				$('#test').append(data['htmlList'][i]);  }
			        	},

			        	error: function(jqXHR, textStatus, errorThrown) {
			        		if(jqXHR.status ==500){
			        			$("#spinner").css("display", "none");
			        			$('#searchFail').css("display","block");
			        		}
						}
			         	
			         	});

					};

				{% if not user.is_authenticated %} 
					var user = null;
				{% else %}
					var user="{{user.name}}";
				{% endif %}

				function renderLoggedInView(){
					if (user) {
						$("#userLoggedIn").removeClass("hidden");
						$("#userNotLoggedIn").addClass("hidden");
					} else {
						$("#userLoggedIn").addClass("hidden");
						$("#userNotLoggedIn").removeClass("hidden");
					}
				};

			</script>



			</div>

			<div id = "footer">
				This is in no way associated with the arxiv.....
			</div>


		</div>




</body>

</html>